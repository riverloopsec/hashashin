import os

from hashashin.utils import cache_hash
from tqdm import tqdm
from multiprocessing import Pool

if __name__ == '__main__':
    # binaries = get_binaries(BINARY_DIR)
    binaries = ['/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/echo', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmptranslate', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpset', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpdelta', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpinform', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpdf', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpstatus', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpusm', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpvacm', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/encode_keychange', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/agentxtrap', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpnetstat', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpgetnext', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpbulkwalk', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmptrap', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpget', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmptable', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpbulkget', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpping', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmpwalk', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/bin/snmptest', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/sbin/snmpd', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.3/sbin/snmptrapd', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmptranslate', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpset', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpdelta', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpinform', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpdf', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpstatus', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpusm', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpvacm', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/encode_keychange', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/agentxtrap', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpnetstat', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpgetnext', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpbulkwalk', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmptrap', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpget', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmptable', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpbulkget', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpping', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmpwalk', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/bin/snmptest', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/sbin/snmpd', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/net-snmp/v5.9.2/sbin/snmptrapd', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_49_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_66_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_81_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_49_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_68_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_62_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_78_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_72_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_53_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_57_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_76_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_53_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_59_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_76_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_65_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_82_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_61_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_65_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_61_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_8/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_54_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_50_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_71_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_75_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_54_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_9/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_50_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_71_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_9_2/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_83_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_64_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_64_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_83_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_60_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_55_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_70_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_55_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_74_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_51_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_69_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_65_3/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_80_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_67_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_84_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_63_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_69_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_65_2/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_52_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_73_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_79_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_50_2/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_56_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_79_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_58_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_50_3/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_52_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_77_0/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/libcurl/curl-7_56_1/bin/curl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/busybox', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.1/bin/openssl(1)', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.1/bin/openssl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.1/lib/ossl-modules/legacy(1).so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.1/lib/ossl-modules/legacy.so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.0/bin/openssl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.0/lib/ossl-modules/legacy.so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.5/bin/openssl(1)', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.5/bin/openssl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.5/lib/ossl-modules/legacy(1).so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.5/lib/ossl-modules/legacy.so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.2/bin/openssl(1)', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.2/bin/openssl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.2/lib/ossl-modules/legacy(1).so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.2/lib/ossl-modules/legacy.so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.3/bin/openssl(1)', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.3/bin/openssl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.3/lib/ossl-modules/legacy(1).so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.3/lib/ossl-modules/legacy.so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.4/bin/openssl(1)', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.4/bin/openssl', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.4/lib/ossl-modules/legacy(1).so', '/Users/jonathan.prokos/Documents/Projects/hashashin/hashashin/binary_data/openssl/openssl-3.0.4/lib/ossl-modules/legacy.so']
    # _ = [cache_hash(b) for b in binaries]
    with Pool(max(os.cpu_count() // 2, 1)) as p:
        list(tqdm(p.imap_unordered(cache_hash, binaries), total=len(binaries)))
